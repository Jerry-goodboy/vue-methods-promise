{"version":3,"file":"vue-methods-promise.min.js","sources":["../src/isPromise.js","../src/hijack.js","../src/index.js","../src/isObject.js","../src/methodsPromise.js"],"sourcesContent":["export default function isPromise (obj) {\n  return Object.prototype.toString.call(obj) === '[object Promise]' || (!!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.constructor === 'function' && !Object.hasOwnProperty.call(obj, 'constructor') && obj.constructor.name === 'Promise')\n}\n","import isPromise from './isPromise'\n\nexport default function hijack (opt, native) {\n  function vueMethodsPromise () {\n    let back = native.apply(this, arguments)\n    if (isPromise(back)) {\n      if (typeof this[opt.hookName] === 'function') {\n        let hookBack = this[opt.hookName](back)\n        if (isPromise(hookBack)) {\n          opt.promise.call(this, back)\n        }\n      } else {\n        opt.promise.call(this, back)\n      }\n    }\n    return back\n  }\n  vueMethodsPromise._vueMethodsPromise = true // 加个标记，避免重复劫持，导致栈溢出\n  return vueMethodsPromise\n}\n","import methodsPromise from './methodsPromise'\n\nexport default function install (Vue, opt) {\n  if (install.installed) return // already installed\n\n  Vue.mixin(methodsPromise(opt))\n}\n","export default function (obj) {\n  return Object.prototype.toString.call(obj) === '[object Object]'\n}\n","import isObject from './isObject'\nimport hijack from './hijack'\n\nexport default (opt = {}) => {\n  // Configure the hook function\n  if (typeof opt.hookName !== 'string') {\n    opt.hookName = '$promise'\n  }\n  // Global hook function\n  if (typeof opt.promise !== 'function') {\n    opt.promise = (mp) => {\n      mp.catch((err) => {\n        console.log(err)\n      })\n    }\n  }\n\n  return {\n    beforeCreate () {\n      const { methods } = this.$options\n      if (!isObject(methods)) return\n      Object.keys(methods).forEach((k) => {\n        let fn = methods[k]\n        if (fn._vueMethodsPromise !== true && typeof fn === 'function' && k !== opt.hookName) {\n          methods[k] = hijack(opt, fn)\n        }\n      })\n    }\n  }\n}\n"],"names":["isPromise","obj","Object","prototype","toString","call","constructor","hasOwnProperty","name","hijack","opt","native","vueMethodsPromise","back","apply","this","arguments","hookName","hookBack","promise","_vueMethodsPromise","install","Vue","installed","mixin","methodsPromise","mp","catch","err","log","methods","$options","isObject","keys","forEach","k","fn"],"mappings":"4LAAe,SAASA,GAAWC,SACc,qBAAxCC,OAAOC,UAAUC,SAASC,KAAKJ,MAAkCA,IAAuB,qBAARA,gBAAAA,KAAmC,kBAARA,KAAkD,kBAApBA,GAAIK,cAA+BJ,OAAOK,eAAeF,KAAKJ,EAAK,gBAA2C,YAAzBA,EAAIK,YAAYE,KCCxO,QAASC,GAAQC,EAAKC,WAC1BC,QACHC,GAAOF,EAAOG,MAAMC,KAAMC,cAC1BhB,EAAUa,MACsB,kBAAvBE,MAAKL,EAAIO,UAA0B,IACxCC,GAAWH,KAAKL,EAAIO,UAAUJ,EAC9Bb,GAAUkB,MACRC,QAAQd,KAAKU,KAAMF,UAGrBM,QAAQd,KAAKU,KAAMF,SAGpBA,YAESO,oBAAqB,EAChCR,EChBM,QAASS,GAASC,EAAKZ,GAChCW,EAAQE,aAERC,MAAMC,EAAef,ICL3B,MAAe,SAAUT,SACwB,oBAAxCC,OAAOC,UAAUC,SAASC,KAAKJ,gOCExBS,mEAEc,gBAAjBA,GAAIO,aACTA,SAAW,YAGU,kBAAhBP,GAAIS,YACTA,QAAU,SAACO,KACVC,MAAM,SAACC,WACAC,IAAID,mCAONE,GAAYf,KAAKgB,SAAjBD,OACHE,GAASF,WACPG,KAAKH,GAASI,QAAQ,SAACC,MACxBC,GAAKN,EAAQK,EACbC,GAAGhB,sBAAuB,GAAsB,kBAAPgB,IAAqBD,IAAMzB,EAAIO,aAClEkB,GAAK1B,EAAOC,EAAK0B"}